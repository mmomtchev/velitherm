# Velitherm

[![License: LGPL v3](https://img.shields.io/badge/License-LGPL%20v3-blue.svg)](https://www.gnu.org/licenses/lgpl-3.0)
[![Node.js CI](https://github.com/mmomtchev/velitherm/actions/workflows/node.js.yml/badge.svg)](https://github.com/mmomtchev/velitherm/actions/workflows/node.js.yml)
[![npm version](https://img.shields.io/npm/v/velitherm)](https://www.npmjs.com/package/velitherm)
[![codecov](https://codecov.io/gh/mmomtchev/velitherm/branch/main/graph/badge.svg?token=aU1ATy8HKv)](https://codecov.io/gh/mmomtchev/velitherm)

A library of basic thermodynamics equations for soaring flight.

As used by the weather site https://www.velivole.fr / https://www.meteo.guru

Zero-dependency!

# Installation

    npm install --save velitherm

# Usage

## Common JS

```js
const velitherm = require('velitherm');

assert(velitherm.altitudeFromPressure(898.746) === 1000);
```

## ECMAScript 6

```js
import * as velitherm from 'velitherm';

assert(velitherm.altitudeFromPressure(898.746) === 1000);
```

## TypeScript

```js
import * as velitherm from 'velitherm';

assert(velitherm.altitudeFromPressure(898.746) === 1000);
```

# Example

An air parcel with relative humidify of 75% and temperature of 25°C rises from 0m AMSL to 500m AMSL where the surrounding temperature is 20°C. What is its new relative humidity? What is its new temperature? Has there been condensation and did it form a cloud? Has the ceiling being reached or will the air parcel continue to rise? The pressure of the day is 1017hPa.

Solution:
```ts
import * as velitherm from 'velitherm';

// As the air rises, its specific humidity remains constant.
const q = velitherm.specificHumidity(75, 1017, 25);
console.log('Specific humidity = ', Math.round(q), 'g/kg');

// Find the current pressure at 500m AMSL
const P1 = velitherm.pressureFromAltitude(500, 1017, 25);
console.log('Pressure at 500m = ', Math.round(P1), 'hPa');

// Compute the new relative humidity of the air parcel at this pressure
const w1 = velitherm.relativeHumidity(q, P1, 20);
console.log('Relative humidity after rising to 500m = ', Math.round(w1), '%');

// Take into account the adiabatic cooling
const T1 = 25 - 500 * velitherm.gamma;
console.log('The new temperature of the air parcel at 500m = ', T1, '°C');

// If the air parcel has reached 100% humidity, there is condensation
if (w1 < 100) {
  console.log('No, it did not form a cloud');
} else {
  console.log('Yes, it did form a cloud');
}

// If the air parcel is still warmer than the surrounding air,
// it will continue to rise
if (T1 < 20) {
  console.log('The ceiling has been reached');
} else {
  console.log('The air parcel will continue to rise');
}

```

# API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

*   [velitherm](#velitherm)
*   [G](#g)
*   [Cp](#cp)
*   [L](#l)
*   [gamma](#gamma)
*   [P0](#p0)
*   [T0](#t0)
*   [Rd](#rd)
*   [Rv](#rv)
*   [Md](#md)
*   [Mv](#mv)
*   [R](#r)
*   [altitudeFromStandardPressure](#altitudefromstandardpressure)
    *   [Parameters](#parameters)
*   [pressureFromStandardAltitude](#pressurefromstandardaltitude)
    *   [Parameters](#parameters-1)
*   [altitudeFromPressure](#altitudefrompressure)
    *   [Parameters](#parameters-2)
*   [pressureFromAltitude](#pressurefromaltitude)
    *   [Parameters](#parameters-3)
*   [waterVaporSaturationPressure](#watervaporsaturationpressure)
    *   [Parameters](#parameters-4)
*   [relativeHumidity](#relativehumidity)
    *   [Parameters](#parameters-5)
*   [mixingRatio](#mixingratio)
    *   [Parameters](#parameters-6)
*   [specificHumidity](#specifichumidity)
    *   [Parameters](#parameters-7)
*   [airDensity](#airdensity)
    *   [Parameters](#parameters-8)

## velitherm

velivole.fr/meteo.guru Basic Thermodynamics Equations for Soaring Flight

Copyright © 2022 Momtchil Momtchev <momtchil@momtchev.com>

Licensed under the LGPL License, Version 3.0 (the "License")
You may not use this file except in compliance with the License.
You may obtain a copy of the License at: <https://www.gnu.org/licenses/lgpl-3.0.en.html>

All methods use:

Pressure in hPa

Temperature in °C

Height in meters

Relative humidity in % from 0 to 100

Specific humidity in g/kg

Mixing ration in g/kg

Type: [string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)

## G

Earth's average gravity acceleration (m/s2)

Type: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)

## Cp

The thermal capacity of air (J/kg)

Type: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)

## L

The enthalpy of vaporization of water (J/kg)

Type: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)

## gamma

The adiabatic lapse rate of dry air (°C/m)

Type: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)

## P0

The average sea level pressure (hPa)

Type: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)

## T0

The temperature of the ICAO standard atmosphere (°C)

Type: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)

## Rd

The specific gas constant of dry air J/(kg\*K)

Type: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)

## Rv

The specific gas constant of water vapor J/(kg\*K)

Type: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)

## Md

Molar mass of dry air kg/mol

Type: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)

## Mv

Molar mass of water vapor kg/mol

Type: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)

## R

Universal gas constant J/(kg\*mol)

Type: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)

## altitudeFromStandardPressure

Altitude from pressure using the barometric formula and ICAO's definition of standard atmosphere

### Parameters

*   `pressure` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Pressure
*   `pressure0` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** Optional sea-level pressure of the day (optional, default `P0`)

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

## pressureFromStandardAltitude

Pressure from altitude using the barometric formula and ICAO's definition of standard atmosphere

### Parameters

*   `height` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Height
*   `pressure0` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** Optional sea-level pressure of the day (optional, default `P0`)

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

## altitudeFromPressure

Altitude from pressure using the hypsometric formula

### Parameters

*   `pressure` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Pressure
*   `pressure0` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** Optional sea-level pressure of the day
*   `temp` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** Optional temperature, T0 otherwise (optional, default `T0`)

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

## pressureFromAltitude

Pressure from altitude using the hypsometric formula

### Parameters

*   `height` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Height
*   `pressure0` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** Optional sea-level pressure of the day (optional, default `P0`)
*   `temp` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** Optional temperature, T0 otherwise (optional, default `T0`)

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

## waterVaporSaturationPressure

(Saturation) Water vapor pressure

### Parameters

*   `temp` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Temperature (optional, default `T0`)

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

## relativeHumidity

Relative humidity

### Parameters

*   `specificHumidity` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Specific humidity
*   `pressure` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** Optional pressure (optional, default `P0`)
*   `temp` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** Optional temperature (optional, default `T0`)

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

## mixingRatio

Mixing ratio

### Parameters

*   `specificHumidity` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Specific humidity

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

## specificHumidity

Specific humidity

### Parameters

*   `relativeHumidity` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Relative humidity
*   `pressure` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** Optional pressure (optional, default `P0`)
*   `temp` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** Optional temperature (optional, default `T0`)

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

## airDensity

Air density

### Parameters

*   `relativeHumidity` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Relative humidity
*   `pressure` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** Optional pressure (optional, default `P0`)
*   `temp` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** Optional temperature (optional, default `T0`)

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
